<html >

    <!-- Begin Head -->
    <head >
        <meta charset="UTF-8"  /><meta name="author" content="Martin Walther - @tinuwalther"  />
        <meta name="keywords" content="Pode, PSHTML, PowerShell, Mermaid Diagram"  />
        <meta name="description" content="Builds beatuifull HTML-Files with PSHTML from native PowerShell-Scripts"  />
        
        <link rel="stylesheet" href="\assets\BootStrap\bootstrap.min.css"  />
        <link rel="stylesheet" href="\assets\style\style.css"  />
        <link rel="stylesheet" href='\assets\BootStrap\bootstrap-icons.css'>

        <script src="\assets\BootStrap\bootstrap.bundle.min.js"  ></script>
        <script src="\assets\Chartjs\Chart.bundle.min.js"  >
        </script>
        
        <title >#PSRotaMaster</title><link type="image/x-icon" href="/assets/img/favicon.ico" rel="icon"  />

        <style>
            #calendar {
                max-width: 900px;
                margin: 30px auto;
            }
        </style>

    </head>
    <!-- End Head -->

    <!-- Begin Body -->
    <Body >
        <header >
            <div Class="jumbotron text-center" Id="j1" Style="padding:15; background-color:#012456"  >
                <p ><h1 >#PSRotaMaster - PS calendar</h1></p>
            </div>
        </header>
    
        <Section Id="section"  >
            <nav Class="navbar navbar-expand-sm bg-dark navbar-dark sticky-top"  >
                <div Class="container-fluid"  >
                    <a Class="navbar-brand" href="/" Target="_self"  >»HOME</a>
                    <button Class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#collapsibleNavbar"  >
                        <span Class="navbar-toggler-icon"  ></span>
                    </button>
                    <div Id="collapsibleNavbar" Class="collapse navbar-collapse"  >
                    <ul Class="navbar-nav"  >
                        <li Class="nav-item"  ><a Class="nav-link" href="https://github.com/tinuwalther/" Target="_blank"  >GitLab</a></li>
                        <li Class="nav-item"  ><a Class="nav-link" href="https://pshtml.readthedocs.io/en/latest/" Target="_blank"  >PSHTML</a></li>
                        <li Class="nav-item"  ><a Class="nav-link" href="https://www.w3schools.com/html/" Target="_blank"  >HTML</a></li>
                        <li Class="nav-item"  ><a Class="nav-link" href="https://getbootstrap.com/" Target="_blank"  >Bootstrap</a></li>
                    </ul>
                    </div>
                </div>
            </nav>
        
            <div Class="container"  >
                <article Id="CalendarBox">

                    <div id="events-log">
                        <h3>Events</h3>
                        <form action="/api/new-events" method="POST">
                            <label for="name">Name</label><br>
                            <input type="text" id="name" name="name"><br><br>

                            <label for="type">Typ der Abwesenheit</label><br>
                            <select id="type" name="type">
                                <option value="ferien">Ferien</option>
                                <option value="militaer">Militärdienst</option>
                                <option value="zivildienst">Zivildienst</option>
                                <option value="pikett">Pikettdienst</option>
                            </select><br><br>

                            <label for="start">Startdatum</label><br>
                            <input type="date" id="start" name="start"><br><br>

                            <label for="end">Enddatum</label><br>
                            <input type="date" id="end" name="end"><br><br>

                            <label for="submit">Action</label><br>
                            <input type="submit" value="Absenden">
                        </form>
                    </div>

                    <div id="calendar">

                        $($Year  = Get-Date -f 'yyyy')
                        $($Month = Get-Date -f 'MMMM')

                        <div class="btn-group" role="group" aria-label="Months">
                            <button type="button" onclick="alert('Hello $( Get-Date (Get-Date).AddMonths(-1) -f 'MMMM' )!')" class="btn btn-primary"><</button>
                            <button type="button" onclick="alert('Hello $( Get-Date (Get-Date).AddMonths(+1) -f 'MMMM' )!')" class="btn btn-primary">></button>
                        </div>

                        $($monthAbbreviation = Get-MonthAbbreviation -MonthName $Month)
                        $($MonthlyCalendar = Get-MonthCalendar -MonthName $Month -Year $Year | Select-Object @{N='Jahr';E={$Year}}, @{N='Monat';E={$monthAbbreviation}}, *)
                        $($SplatProperties = @{
                                TableClass = 'table table-dark table-striped-columns table-responsive table-striped table-hover'
                                TheadClass = 'thead-dark'
                                Properties = @('Woche','Sonntag','Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag')
                            }
                        )
                        <h1>$($Month) $($Year)</h1>
                        $($MonthlyCalendar | ConvertTo-PSHtmlTable @SplatProperties)

                    </div>
                </article>
            </div>
        </Section>
    
    </Body>
    <!-- End Body -->
 
    <!-- Begin Footer -->
    <footer>
        <div Class="container-fluid"  >

            <div Class="row align-items-center"  >

                <div Class="col-md"  >
                    <p >
                        <a Class="btn-sm btn btn-outline-success" href="#" Target="_self"  >I ♥ PS ></a>
                    </p>
                </div>
                    
                <div Class="col-md"  >
                    <p >
                        <a href="https://www.powershellgallery.com/packages/Pode" Target="_blank"  >pode</a> and <a href="https://www.powershellgallery.com/packages/PSHTML" Target="_blank"  >PSHTML</a>
                    </p>
                </div>

                <div Class="col-md" Style="color:#000"  >
                    <p >Created at 2024-09-15 10:57:33</p>
                </div>

            </div>

        </div>
    </footer>
    <!--End Footer -->

</html>
